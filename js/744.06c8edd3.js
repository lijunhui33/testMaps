"use strict";(self["webpackChunkvue2_0"]=self["webpackChunkvue2_0"]||[]).push([[744],{1744:function(e,t,i){i.r(t),i.d(t,{default:function(){return c}});var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("div",{staticClass:"container-title"},[e._v(e._s("add"==e.type?"新增":"编辑")+"投票活动")]),t("div",{staticClass:"form-box"},[t("el-form",{ref:"form",attrs:{model:e.form,"label-width":"140px"}},[t("el-form-item",{attrs:{label:"投票活动标题",required:""}},[t("el-input",{attrs:{disabled:e.disabled,placeholder:"请输入活动标题"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),t("el-form-item",{attrs:{label:"投票活动描述"}},[t("el-input",{attrs:{disabled:e.disabled,placeholder:"请输入活动描述",type:"textarea",autosize:{minRows:6,maxRows:10}},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),t("el-form-item",{attrs:{label:"投票日期",required:""}},[t("el-date-picker",{attrs:{disabled:e.disabled,type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.timerArr,callback:function(t){e.timerArr=t},expression:"timerArr"}})],1),t("el-form-item",[t("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.disabled,expression:"!disabled"}],attrs:{type:"primary",loading:e.loading},on:{click:e.save}},[e._v("保存")]),t("el-button",{on:{click:e.back}},[e._v("返回")])],1)],1)],1)])},s=[],a=(i(7658),i(8208)),o=i(9488),n={components:{},data(){return{form:{description:"",title:""},fileList:[],loading:!1,timerArr:[],disabled:!1}},created(){this.addressList=this.$store.state.addressList;const{type:e,id:t}=this.$route.query;this.type=e,"edit"!=e&&"preview"!=e||!t||(this.id=t,this.getDetail()),"preview"==e&&(this.disabled=!0)},methods:{getDetail(){(0,a.nF)({id:this.id}).then((e=>{if(0==e.data.code){const t=(0,o.Z)(e.data.data.beginTime),i=(0,o.Z)(e.data.data.endTime);t&&i&&(this.timerArr=[t,i]),this.form.description=e.data.data.description,this.form.title=e.data.data.title}}))},back(){this.$router.go(-1)},addTag(){this.tag&&(-1===this.tagList.indexOf(this.tag)?(this.tagList.push(this.tag),this.tag=""):this.$message.error("重复标签"))},save(){this.form.title?this.form.description?this.timerArr.length?"add"===this.type?this.addVote():this.upData():this.$message.error("请选择投票时间"):this.$message.error("请填写描述"):this.$message.error("请填写标题")},upData(){const e=this.timerArr[0]?new Date(this.timerArr[0]).getTime():"",t=this.timerArr[1]?new Date(this.timerArr[1]).getTime():"";this.loading=!0,(0,a.UX)({...this.form,beginTime:e,endTime:t,id:this.id}).then((e=>{0==e.data.code?(this.$message.success("更新成功"),setTimeout((()=>{this.$router.go(-1)}),2e3)):this.$message.error(`${e.data.message},${e.data.detail}`),this.loading=!1})).catch((()=>{this.loading=!1}))},addVote(){const e=this.timerArr[0]?new Date(this.timerArr[0]).getTime():"",t=this.timerArr[1]?new Date(this.timerArr[1]).getTime():"";(0,a.m7)({...this.form,beginTime:e,endTime:t}).then((e=>{console.log(e.data),0==e.data.code?(this.$message.success("创建成功"),setTimeout((()=>{this.$router.go(-1)}),2e3)):this.$message.error(`${e.data.message},${e.data.detail}`)}))},handleRemove(e,t){console.log(e,t)},handlePreview(e){console.log(e)},handleExceed(e,t){this.$message.warning(`当前限制选择 3 个文件，本次选择了 ${e.length} 个文件，共选择了 ${e.length+t.length} 个文件`)},beforeRemove(e){return this.$confirm(`确定移除 ${e.name}？`)},change(e){return console.log(e),!0}}},d=n,l=i(1001),m=(0,l.Z)(d,r,s,!1,null,"7f35d3d5",null),c=m.exports},8208:function(e,t,i){i.d(t,{UX:function(){return n},Us:function(){return a},eE:function(){return l},f$:function(){return h},iz:function(){return d},lJ:function(){return c},m7:function(){return s},nF:function(){return o},q3:function(){return m}});var r=i(8108);const s=e=>(0,r.xW)("/vote/create",e),a=e=>(0,r.FP)("/vote/list",e),o=e=>(0,r.FP)("/vote/detail",e),n=e=>(0,r.xW)("/vote/update",e),d=e=>(0,r.xW)("/vote/delete",e),l=e=>(0,r.xW)("/vote/option/create/batch",e),m=e=>(0,r.FP)("/vote/option/list",e),c=e=>(0,r.xW)("/vote/option/delete",e),h=e=>(0,r.xW)("/vote/option/update",e)},9488:function(e,t){const i=e=>{if(!e)return"";const t=e=>e>=10?e:"0"+e,i=new Date(Number(e)),r=i.getFullYear(),s=i.getMonth()+1,a=i.getDate(),o=i.getHours(),n=i.getMinutes(),d=i.getSeconds();return r+"-"+t(s)+"-"+t(a)+" "+t(o)+":"+t(n)+":"+t(d)};t["Z"]=i}}]);
//# sourceMappingURL=744.06c8edd3.js.map