{"version":3,"file":"js/744.06c8edd3.js","mappings":"wJAAA,IAAIA,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACE,YAAY,aAAa,CAACF,EAAG,MAAM,CAACE,YAAY,mBAAmB,CAACJ,EAAIK,GAAGL,EAAIM,GAAe,OAAZN,EAAIO,KAAgB,KAAK,MAAM,UAAUL,EAAG,MAAM,CAACE,YAAY,YAAY,CAACF,EAAG,UAAU,CAACM,IAAI,OAAOC,MAAM,CAAC,MAAQT,EAAIU,KAAK,cAAc,UAAU,CAACR,EAAG,eAAe,CAACO,MAAM,CAAC,MAAQ,SAAS,SAAW,KAAK,CAACP,EAAG,WAAW,CAACO,MAAM,CAAC,SAAWT,EAAIW,SAAS,YAAc,WAAWC,MAAM,CAACC,MAAOb,EAAIU,KAAKI,MAAOC,SAAS,SAAUC,GAAMhB,EAAIiB,KAAKjB,EAAIU,KAAM,QAASM,EAAK,EAACE,WAAW,iBAAiB,GAAGhB,EAAG,eAAe,CAACO,MAAM,CAAC,MAAQ,WAAW,CAACP,EAAG,WAAW,CAACO,MAAM,CAAC,SAAWT,EAAIW,SAAS,YAAc,UAAU,KAAO,WAAW,SAAW,CAAEQ,QAAS,EAAGC,QAAS,KAAKR,MAAM,CAACC,MAAOb,EAAIU,KAAKW,YAAaN,SAAS,SAAUC,GAAMhB,EAAIiB,KAAKjB,EAAIU,KAAM,cAAeM,EAAK,EAACE,WAAW,uBAAuB,GAAGhB,EAAG,eAAe,CAACO,MAAM,CAAC,MAAQ,OAAO,SAAW,KAAK,CAACP,EAAG,iBAAiB,CAACO,MAAM,CAAC,SAAWT,EAAIW,SAAS,KAAO,gBAAgB,kBAAkB,IAAI,oBAAoB,OAAO,kBAAkB,OAAO,eAAe,uBAAuBC,MAAM,CAACC,MAAOb,EAAIsB,SAAUP,SAAS,SAAUC,GAAMhB,EAAIsB,SAASN,CAAI,EAACE,WAAW,eAAe,GAAGhB,EAAG,eAAe,CAACA,EAAG,YAAY,CAACqB,WAAW,CAAC,CAACC,KAAK,OAAOC,QAAQ,SAASZ,OAAQb,EAAIW,SAAUO,WAAW,cAAcT,MAAM,CAAC,KAAO,UAAU,QAAUT,EAAI0B,SAASC,GAAG,CAAC,MAAQ3B,EAAI4B,OAAO,CAAC5B,EAAIK,GAAG,QAAQH,EAAG,YAAY,CAACyB,GAAG,CAAC,MAAQ3B,EAAI6B,OAAO,CAAC7B,EAAIK,GAAG,SAAS,IAAI,IAAI,IACj9C,EACGyB,EAAkB,G,8BC+BtB,GACAC,WAAAA,CAAAA,EAEAC,OACA,OACAtB,KAAAA,CACAW,YAAAA,GACAP,MAAAA,IAEAmB,SAAAA,GAGAP,SAAAA,EACAJ,SAAAA,GACAX,UAAAA,EAEA,EACAuB,UACA,+CACA,WAAA3B,EAAAA,GAAA4B,GAAA,kBACA,YACA,8BACA,UACA,kBAEA,eACA,iBAEA,EACAC,QAAAA,CACAC,aACAC,EAAAA,EAAAA,IAAAA,CAAAH,GAAAA,KAAAA,KAAA,UACA,mBACA,uCACA,+BACA,OACA,qBAEA,8CACA,iCACA,IAEA,EACAN,OACA,mBACA,EACAU,SACA,YACA,oCACA,4BACA,aAEA,4BAGA,EACAX,OACA,gBAIA,sBAIA,qBAIA,kBACA,eAEA,cANA,+BAJA,6BAJA,4BAgBA,EACAY,SACA,iEACA,2DACA,iBACAC,EAAAA,EAAAA,IAAAA,IACA,UACAC,YACAC,UACAR,GAAAA,KAAAA,KACAS,MAAAC,IACA,gBACA,8BACAC,YAAAA,KACA,sBACA,MAEA,0DAEA,mBACAC,OAAA,KACA,kBAEA,EACAC,UACA,iEACA,4DACAC,EAAAA,EAAAA,IAAAA,IACA,UACAP,YACAC,YACAC,MAAAC,IACAK,QAAAA,IAAAA,EAAAA,MACA,gBACA,8BACAJ,YAAAA,KACA,sBACA,MAEA,yDACA,GAEA,EACAK,aAAAA,EAAAA,GACAD,QAAAA,IAAAA,EAAAA,EACA,EACAE,cAAAA,GACAF,QAAAA,IAAAA,EACA,EACAG,aAAAA,EAAAA,GACA,yFACA,EACAC,aAAAA,GACA,uCACA,EACAC,OAAAA,GAEA,OADAL,QAAAA,IAAAA,IACA,CACA,ICrKsQ,I,UCQlQM,GAAY,OACd,EACAzD,EACA+B,GACA,EACA,KACA,WACA,MAIF,EAAe0B,EAAiB,O,sQChBzB,MAAMP,EAAcQ,IAChBC,EAAAA,EAAAA,IAAU,eAAgBD,GAIxBE,EAAYF,IACdG,EAAAA,EAAAA,IAAS,aAAcH,GAIrBnB,EAAcmB,IAChBG,EAAAA,EAAAA,IAAS,eAAgBH,GAIvBhB,EAAcgB,IAChBC,EAAAA,EAAAA,IAAU,eAAgBD,GAIxBI,EAAcJ,IAChBC,EAAAA,EAAAA,IAAU,eAAgBD,GAIxBK,EAAoBL,IACtBC,EAAAA,EAAAA,IAAU,4BAA6BD,GAIrCM,EAAkBN,IACpBG,EAAAA,EAAAA,IAAS,oBAAqBH,GAI5BO,EAAoBP,IACtBC,EAAAA,EAAAA,IAAU,sBAAuBD,GAI/BQ,EAAoBR,IACtBC,EAAAA,EAAAA,IAAU,sBAAuBD,E,qBC5C5C,MAAMS,EAAgBC,IAClB,IAAKA,EACD,MAAO,GAEX,MAAMC,EAAcD,GACTA,GAAO,GAAKA,EAAM,IAAMA,EAE7BE,EAAO,IAAIC,KAAKC,OAAOJ,IACvBK,EAAOH,EAAKI,cACZC,EAAQL,EAAKM,WAAa,EAC1BC,EAAMP,EAAKQ,UACXC,EAAOT,EAAKU,WACZC,EAAUX,EAAKY,aACfC,EAAUb,EAAKc,aACrB,OAAOX,EAAO,IAAMJ,EAAWM,GAAS,IAAMN,EAAWQ,GAAO,IAAMR,EAAWU,GAAQ,IAAMV,EAAWY,GAAW,IAAMZ,EAAWc,EAAtI,EAKJ,Q","sources":["webpack://vue2.0/./src/view/vote/voteAddOrEdit.vue","webpack://vue2.0/src/view/vote/voteAddOrEdit.vue","webpack://vue2.0/./src/view/vote/voteAddOrEdit.vue?459e","webpack://vue2.0/./src/view/vote/voteAddOrEdit.vue?3d22","webpack://vue2.0/./src/api/vote.js","webpack://vue2.0/./src/utils/timerHandler.js"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"container\"},[_c('div',{staticClass:\"container-title\"},[_vm._v(_vm._s(_vm.type == 'add' ? '新增':'编辑')+\"投票活动\")]),_c('div',{staticClass:\"form-box\"},[_c('el-form',{ref:\"form\",attrs:{\"model\":_vm.form,\"label-width\":\"140px\"}},[_c('el-form-item',{attrs:{\"label\":\"投票活动标题\",\"required\":\"\"}},[_c('el-input',{attrs:{\"disabled\":_vm.disabled,\"placeholder\":\"请输入活动标题\"},model:{value:(_vm.form.title),callback:function ($$v) {_vm.$set(_vm.form, \"title\", $$v)},expression:\"form.title\"}})],1),_c('el-form-item',{attrs:{\"label\":\"投票活动描述\"}},[_c('el-input',{attrs:{\"disabled\":_vm.disabled,\"placeholder\":\"请输入活动描述\",\"type\":\"textarea\",\"autosize\":{ minRows: 6, maxRows: 10}},model:{value:(_vm.form.description),callback:function ($$v) {_vm.$set(_vm.form, \"description\", $$v)},expression:\"form.description\"}})],1),_c('el-form-item',{attrs:{\"label\":\"投票日期\",\"required\":\"\"}},[_c('el-date-picker',{attrs:{\"disabled\":_vm.disabled,\"type\":\"datetimerange\",\"range-separator\":\"至\",\"start-placeholder\":\"开始日期\",\"end-placeholder\":\"结束日期\",\"value-format\":\"yyyy-MM-dd HH:mm:ss\"},model:{value:(_vm.timerArr),callback:function ($$v) {_vm.timerArr=$$v},expression:\"timerArr\"}})],1),_c('el-form-item',[_c('el-button',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.disabled),expression:\"!disabled\"}],attrs:{\"type\":\"primary\",\"loading\":_vm.loading},on:{\"click\":_vm.save}},[_vm._v(\"保存\")]),_c('el-button',{on:{\"click\":_vm.back}},[_vm._v(\"返回\")])],1)],1)],1)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\"container\">\r\n        <div class=\"container-title\">{{type == 'add' ? '新增':'编辑'}}投票活动</div>\r\n        <div class=\"form-box\">\r\n            <el-form ref=\"form\" :model=\"form\" label-width=\"140px\">\r\n                <el-form-item label=\"投票活动标题\" required>\r\n                    <el-input :disabled=\"disabled\" placeholder=\"请输入活动标题\" v-model=\"form.title\"></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"投票活动描述\">\r\n                    <el-input :disabled=\"disabled\" placeholder=\"请输入活动描述\" type=\"textarea\" :autosize=\"{ minRows: 6, maxRows: 10}\" v-model=\"form.description\"></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"投票日期\" required>\r\n                    <el-date-picker :disabled=\"disabled\" v-model=\"timerArr\" type=\"datetimerange\" range-separator=\"至\" start-placeholder=\"开始日期\" end-placeholder=\"结束日期\" value-format=\"yyyy-MM-dd HH:mm:ss\">\r\n                    </el-date-picker>\r\n                </el-form-item>\r\n                <!-- <el-form-item label=\"上传文件\">\r\n                    <el-upload ref=\"upload\" action=\"http://localhost:5001/imgUpload\" :on-preview=\"handlePreview\" :on-remove=\"handleRemove\" :before-remove=\"beforeRemove\" multiple :limit=\"5\" :on-exceed=\"handleExceed\" :file-list=\"fileList\" accept=\".png,.jpeg,.jpg,.mp4,.avi\" @before-upload=\"change\" :auto-upload=\"false\" :data=\"form\">\r\n                        <el-button size=\"small\" type=\"primary\">点击上传</el-button>\r\n                        <div slot=\"tip\" class=\"el-upload__tip\">只能上传jpg/png文件，且不超过500kb</div>\r\n                    </el-upload>\r\n                </el-form-item> -->\r\n                <el-form-item>\r\n                    <el-button type=\"primary\" v-show=\"!disabled\" @click=\"save\" :loading=\"loading\">保存</el-button>\r\n                    <el-button @click=\"back\">返回</el-button>\r\n                </el-form-item>\r\n            </el-form>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { voteCreate, voteDetail, voteUpdate } from '@/api/vote';\r\nimport timerHandler from '@/utils/timerHandler';\r\nexport default {\r\n    components: {\r\n    },\r\n    data () {\r\n        return {\r\n            form: {\r\n                description: '',\r\n                title: ''\r\n            },\r\n            fileList: [\r\n                // { name: 'food.jpeg', url: 'https://fuss10.elemecdn.com/3/63/4e7f3a15429bfda99bce42a18cdd1jpeg.jpeg?imageMogr2/thumbnail/360x360/format/webp/quality/100' }, { name: 'food2.jpeg', url: 'https://fuss10.elemecdn.com/3/63/4e7f3a15429bfda99bce42a18cdd1jpeg.jpeg?imageMogr2/thumbnail/360x360/format/webp/quality/100' }\r\n            ],\r\n            loading: false,\r\n            timerArr: [],\r\n            disabled: false\r\n        };\r\n    },\r\n    created () {\r\n        this.addressList = this.$store.state.addressList;\r\n        const { type, id } = this.$route.query;\r\n        this.type = type;\r\n        if ((type == 'edit' || type == 'preview') && id) {\r\n            this.id = id;\r\n            this.getDetail();\r\n        }\r\n        if (type == 'preview') {\r\n            this.disabled = true;\r\n        }\r\n    },\r\n    methods: {\r\n        getDetail () {\r\n            voteDetail({ id: this.id }).then(res => {\r\n                if (res.data.code == 0) {\r\n                    const startTime = timerHandler(res.data.data.beginTime);\r\n                    const endTime = timerHandler(res.data.data.endTime);\r\n                    if (!!startTime && endTime) {\r\n                        this.timerArr = [startTime, endTime];\r\n                    }\r\n                    this.form.description = res.data.data.description;\r\n                    this.form.title = res.data.data.title;\r\n                }\r\n            });\r\n        },\r\n        back () {\r\n            this.$router.go(-1);\r\n        },\r\n        addTag () {\r\n            if (this.tag) {\r\n                if (this.tagList.indexOf(this.tag) === -1) {\r\n                    this.tagList.push(this.tag);\r\n                    this.tag = '';\r\n                } else {\r\n                    this.$message.error('重复标签');\r\n                }\r\n            }\r\n        },\r\n        save () {\r\n            if (!this.form.title) {\r\n                this.$message.error('请填写标题');\r\n                return;\r\n            }\r\n            if (!this.form.description) {\r\n                this.$message.error('请填写描述');\r\n                return;\r\n            }\r\n            if (!this.timerArr.length) {\r\n                this.$message.error('请选择投票时间');\r\n                return;\r\n            }\r\n            if (this.type === 'add') {\r\n                this.addVote();\r\n            } else {\r\n                this.upData();\r\n            }\r\n        },\r\n        upData () {\r\n            const beginTime = this.timerArr[0] ? new Date(this.timerArr[0]).getTime() : '';\r\n            const endTime = this.timerArr[1] ? new Date(this.timerArr[1]).getTime() : '';\r\n            this.loading = true;\r\n            voteUpdate({\r\n                ...this.form,\r\n                beginTime,\r\n                endTime,\r\n                id: this.id\r\n            }).then(res => {\r\n                if (res.data.code == 0) {\r\n                    this.$message.success('更新成功');\r\n                    setTimeout(() => {\r\n                        this.$router.go(-1);\r\n                    }, 2000);\r\n                } else {\r\n                    this.$message.error(`${res.data.message},${res.data.detail}`);\r\n                }\r\n                this.loading = false;\r\n            }).catch(() => {\r\n                this.loading = false;\r\n            });\r\n        },\r\n        addVote () {\r\n            const beginTime = this.timerArr[0] ? new Date(this.timerArr[0]).getTime() : '';\r\n            const endTime = this.timerArr[1] ? new Date(this.timerArr[1]).getTime() : '';\r\n            voteCreate({\r\n                ...this.form,\r\n                beginTime,\r\n                endTime,\r\n            }).then(res => {\r\n                console.log(res.data);\r\n                if (res.data.code == 0) {\r\n                    this.$message.success('创建成功');\r\n                    setTimeout(() => {\r\n                        this.$router.go(-1);\r\n                    }, 2000);\r\n                } else {\r\n                    this.$message.error(`${res.data.message},${res.data.detail}`);\r\n                }\r\n            });\r\n        },\r\n        handleRemove (file, fileList) {\r\n            console.log(file, fileList);\r\n        },\r\n        handlePreview (file) {\r\n            console.log(file);\r\n        },\r\n        handleExceed (files, fileList) {\r\n            this.$message.warning(`当前限制选择 3 个文件，本次选择了 ${files.length} 个文件，共选择了 ${files.length + fileList.length} 个文件`);\r\n        },\r\n        beforeRemove (file) {\r\n            return this.$confirm(`确定移除 ${file.name}？`);\r\n        },\r\n        change (file) {\r\n            console.log(file);\r\n            return true;\r\n        }\r\n    }\r\n\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.form-box {\r\n    width: 50%;\r\n    margin-top: 20px;\r\n    margin-left: 10px;\r\n}\r\n\r\n.tag-list {\r\n    display: flex;\r\n    align-items: center;\r\n}\r\n\r\n.tag {\r\n    margin-top: 20px;\r\n    margin-right: 20px;\r\n}\r\n</style>","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./voteAddOrEdit.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./voteAddOrEdit.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./voteAddOrEdit.vue?vue&type=template&id=7f35d3d5&scoped=true&\"\nimport script from \"./voteAddOrEdit.vue?vue&type=script&lang=js&\"\nexport * from \"./voteAddOrEdit.vue?vue&type=script&lang=js&\"\nimport style0 from \"./voteAddOrEdit.vue?vue&type=style&index=0&id=7f35d3d5&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7f35d3d5\",\n  null\n  \n)\n\nexport default component.exports","import { postAxios, getAxios } from '../utils/http';\r\n\r\n// 发布活动\r\nexport const voteCreate = (params) => {\r\n    return postAxios('/vote/create', params);\r\n};\r\n\r\n// 活动列表\r\nexport const voteList = (params) => {\r\n    return getAxios('/vote/list', params);\r\n};\r\n\r\n// 活动详情\r\nexport const voteDetail = (params) => {\r\n    return getAxios('/vote/detail', params);\r\n};\r\n\r\n// 更新活动\r\nexport const voteUpdate = (params) => {\r\n    return postAxios('/vote/update', params);\r\n};\r\n\r\n// 删除活动\r\nexport const voteDelete = (params) => {\r\n    return postAxios('/vote/delete', params);\r\n};\r\n\r\n// 批量创建选项\r\nexport const voteOptionCreate = (params) => {\r\n    return postAxios('/vote/option/create/batch', params);\r\n};\r\n\r\n// 获取选项的列表\r\nexport const voteOptionList = (params) => {\r\n    return getAxios('/vote/option/list', params);\r\n};\r\n\r\n// 选项删除\r\nexport const voteOptionDelete = (params) => {\r\n    return postAxios('/vote/option/delete', params);\r\n};\r\n\r\n// 选项更新\r\nexport const voteOptionUpdate = (params) => {\r\n    return postAxios('/vote/option/update', params);\r\n};","const timerHandler = (str) => {\r\n    if (!str) {\r\n        return '';\r\n    }\r\n    const isBeginTen = (str) => {\r\n        return str >= 10 ? str : '0' + str;\r\n    };\r\n    const date = new Date(Number(str)); //获取一个时间对象\r\n    const year = date.getFullYear();  // 获取完整的年份(4位,1970)\r\n    const month = date.getMonth() + 1;  // 获取月份(0-11,0代表1月,用的时候记得加上1)\r\n    const day = date.getDate();  // 获取日(1-31)\r\n    const hour = date.getHours();  // 获取小时数(0-23)\r\n    const minutes = date.getMinutes();  // 获取分钟数(0-59)\r\n    const seconds = date.getSeconds();\r\n    return year + '-' + isBeginTen(month) + '-' + isBeginTen(day) + ' ' + isBeginTen(hour) + ':' + isBeginTen(minutes) + ':' + isBeginTen(seconds);\r\n};\r\n\r\n\r\n\r\nexport default timerHandler;"],"names":["render","_vm","this","_c","_self","staticClass","_v","_s","type","ref","attrs","form","disabled","model","value","title","callback","$$v","$set","expression","minRows","maxRows","description","timerArr","directives","name","rawName","loading","on","save","back","staticRenderFns","components","data","fileList","created","id","methods","getDetail","voteDetail","addTag","upData","voteUpdate","beginTime","endTime","then","res","setTimeout","catch","addVote","voteCreate","console","handleRemove","handlePreview","handleExceed","beforeRemove","change","component","params","postAxios","voteList","getAxios","voteDelete","voteOptionCreate","voteOptionList","voteOptionDelete","voteOptionUpdate","timerHandler","str","isBeginTen","date","Date","Number","year","getFullYear","month","getMonth","day","getDate","hour","getHours","minutes","getMinutes","seconds","getSeconds"],"sourceRoot":""}